<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script>
      // Register a custom component to handle the animation logic
      AFRAME.registerComponent('steering-animator', {
        init: function () {
          const el = this.el;
          let isClockwise = true; // Flag to track rotation direction

          // Function to set up the rotation animation
          const animateRotation = (direction, duration, delay) => {
            el.setAttribute('animation', {
              property: 'rotation',
              to: '0 360 0', // Full rotation around the y-axis
              dur: duration,
              easing: 'linear',
              loop: false,
              dir: direction, // 'normal' for clockwise, 'reverse' for anticlockwise
              startEvents: 'start-animation',
            });
          };

          // Define the animation sequence
          const startSequence = () => {
            if (isClockwise) {
              console.log('Animating clockwise...');
              animateRotation('normal', 2000, 0);
              isClockwise = false; // Next time, rotate anticlockwise
            } else {
              console.log('Animating anticlockwise...');
              animateRotation('reverse', 2000, 0);
              isClockwise = true; // Next time, rotate clockwise
            }
            // Trigger the animation
            el.emit('start-animation');
          };

          // Set up a loop to repeat the animation sequence
          setInterval(() => {
            startSequence();
          }, 4000); // Repeat every 4 seconds
        }
      });
    </script>
  </head>
  <body>
    <a-scene>
      <a-entity camera position="0 1.6 2"></a-entity>
      <a-sky color="#ECECEC"></a-sky>

      <a-assets>
            <a-asset-item id="steering" src="steering.glb"></a-asset-item>
        </a-assets>

      <a-entity
        id="steeringWheel"
        gltf-model="#steering"
        position="0 1.3 -1"
        steering-animator
      ></a-entity>
    </a-scene>
  </body>
</html>
